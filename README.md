# Modele-Predictif-Qualite-Produit-Arbre-Decision
<div data-message-author-role="assistant" data-message-id="d3706a2d-c917-4308-a9b1-e65d677baad6" dir="auto" class="text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&amp;]:mt-5" data-message-model-slug="gpt-4o-mini"><div class="flex w-full flex-col gap-1 empty:hidden first:pt-[3px]"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Pour inclure trois produits différents — <strong>Yaourt</strong>, <strong>Biscuit</strong> et <strong>Sauce</strong> — dans l'exemple d'activité pratique utilisant un arbre de décision, nous allons modifier légèrement l'exemple en introduisant la variable "Type de produit". Cette variable influencera la qualité du produit en fonction des conditions de production.</p><p>Voici une version mise à jour de l'activité, prenant en compte les trois produits différents :</p><hr><h3><strong>Activité pratique : Création d’un modèle prédictif utilisant un arbre de décision pour prédire la qualité des produits (Yaourt, Biscuit, Sauce) dans le domaine agroalimentaire</strong></h3><p><strong>Objectif</strong> :<br>Prédire la <strong>qualité des produits</strong> (Yaourt, Biscuit, Sauce) en fonction des variables influençant la production (comme la température, l'humidité et la durée de production) et utiliser un <strong>arbre de décision</strong> pour classer les produits en deux catégories :</p><ul><li><strong>1</strong> : Qualité bonne</li><li><strong>0</strong> : Qualité mauvaise</li></ul><p>Les variables influençant la qualité du produit comprennent :</p><ul><li><strong>Température de cuisson (°C)</strong></li><li><strong>Humidité relative (%)</strong></li><li><strong>Vitesse de production (productions/heure)</strong></li><li><strong>Durée de production (min)</strong></li><li><strong>Type de produit</strong> (Yaourt, Biscuit, Sauce)</li></ul><p>Le but est de prédire si la qualité du produit est bonne ou mauvaise en fonction des conditions de production spécifiques à chaque type de produit.</p><hr><h3><strong>Étapes de l'activité :</strong></h3><h4><strong>Étape 1 : Création du jeu de données simulé</strong></h4><p>Nous allons d'abord créer un jeu de données simulé avec les 3 types de produits : Yaourt, Biscuit, et Sauce. Le jeu de données contiendra également des informations sur les conditions de production et la qualité des produits.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># Création d'un jeu de données simulé avec 3 produits différents</span>
data = {
    <span class="hljs-string">'Température de cuisson (°C)'</span>: [<span class="hljs-number">180</span>, <span class="hljs-number">200</span>, <span class="hljs-number">210</span>, <span class="hljs-number">190</span>, <span class="hljs-number">185</span>, <span class="hljs-number">220</span>, <span class="hljs-number">230</span>, <span class="hljs-number">240</span>, <span class="hljs-number">195</span>, <span class="hljs-number">205</span>, <span class="hljs-number">175</span>, <span class="hljs-number">195</span>, <span class="hljs-number">200</span>, <span class="hljs-number">210</span>, <span class="hljs-number">180</span>],
    <span class="hljs-string">'Humidité relative (%)'</span>: [<span class="hljs-number">60</span>, <span class="hljs-number">55</span>, <span class="hljs-number">70</span>, <span class="hljs-number">65</span>, <span class="hljs-number">62</span>, <span class="hljs-number">75</span>, <span class="hljs-number">80</span>, <span class="hljs-number">85</span>, <span class="hljs-number">63</span>, <span class="hljs-number">68</span>, <span class="hljs-number">70</span>, <span class="hljs-number">65</span>, <span class="hljs-number">60</span>, <span class="hljs-number">55</span>, <span class="hljs-number">75</span>],
    <span class="hljs-string">'Vitesse de production (productions/heure)'</span>: [<span class="hljs-number">50</span>, <span class="hljs-number">55</span>, <span class="hljs-number">50</span>, <span class="hljs-number">45</span>, <span class="hljs-number">60</span>, <span class="hljs-number">65</span>, <span class="hljs-number">60</span>, <span class="hljs-number">55</span>, <span class="hljs-number">52</span>, <span class="hljs-number">58</span>, <span class="hljs-number">45</span>, <span class="hljs-number">50</span>, <span class="hljs-number">60</span>, <span class="hljs-number">65</span>, <span class="hljs-number">50</span>],
    <span class="hljs-string">'Durée de production (min)'</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">25</span>, <span class="hljs-number">22</span>, <span class="hljs-number">18</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">28</span>, <span class="hljs-number">32</span>, <span class="hljs-number">24</span>, <span class="hljs-number">26</span>, <span class="hljs-number">30</span>, <span class="hljs-number">35</span>, <span class="hljs-number">20</span>, <span class="hljs-number">25</span>, <span class="hljs-number">22</span>],
    <span class="hljs-string">'Type de produit'</span>: [<span class="hljs-string">'Yaourt'</span>, <span class="hljs-string">'Yaourt'</span>, <span class="hljs-string">'Biscuit'</span>, <span class="hljs-string">'Biscuit'</span>, <span class="hljs-string">'Sauce'</span>, <span class="hljs-string">'Sauce'</span>, <span class="hljs-string">'Yaourt'</span>, <span class="hljs-string">'Sauce'</span>, <span class="hljs-string">'Biscuit'</span>, <span class="hljs-string">'Yaourt'</span>, <span class="hljs-string">'Sauce'</span>, <span class="hljs-string">'Biscuit'</span>, <span class="hljs-string">'Yaourt'</span>, <span class="hljs-string">'Biscuit'</span>, <span class="hljs-string">'Sauce'</span>],
    <span class="hljs-string">'Qualité du produit (0= mauvaise, 1= bonne)'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]  <span class="hljs-comment"># 1=bonne, 0=mauvaise qualité</span>
}

<span class="hljs-comment"># Charger les données dans un DataFrame</span>
df = pd.DataFrame(data)

<span class="hljs-comment"># Afficher les premières lignes du jeu de données</span>
<span class="hljs-built_in">print</span>(df.head())
</code></div></div></pre><p>Le jeu de données contient maintenant les colonnes suivantes :</p><ul><li><strong>Température de cuisson (°C)</strong></li><li><strong>Humidité relative (%)</strong></li><li><strong>Vitesse de production (productions/heure)</strong></li><li><strong>Durée de production (min)</strong></li><li><strong>Type de produit</strong> (Yaourt, Biscuit, Sauce)</li><li><strong>Qualité du produit (0= mauvaise, 1= bonne)</strong> (variable cible)</li></ul><hr><h4><strong>Étape 2 : Exploration des données</strong></h4><p>Comme dans l'exemple précédent, nous devons explorer le jeu de données pour en comprendre les caractéristiques avant de commencer l'entraînement du modèle.</p><ol><li><strong>Vérification des dimensions du dataset</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions du dataset : "</span>, df.shape)
</code></div></div></pre><ol start="2"><li><strong>Statistiques descriptives</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-built_in">print</span>(df.describe())
</code></div></div></pre><ol start="3"><li><strong>Vérification des valeurs manquantes</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-built_in">print</span>(df.isnull().<span class="hljs-built_in">sum</span>())
</code></div></div></pre><ol start="4"><li><strong>Visualisation des relations entre les variables</strong> :</li></ol><p>Nous allons aussi examiner les relations entre les variables avec un graphique de dispersion, y compris la variable "Type de produit" pour voir si le type de produit affecte la qualité.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># Visualisation des relations entre les variables</span>
sns.pairplot(df, kind=<span class="hljs-string">'scatter'</span>, hue=<span class="hljs-string">'Type de produit'</span>)
plt.show()
</code></div></div></pre><hr><h4><strong>Étape 3 : Préparation des données pour l'entraînement</strong></h4><p>Avant de commencer l'entraînement du modèle, il est nécessaire de traiter la variable catégorielle "Type de produit" en la convertissant en variables numériques à l'aide de l'encodage <strong>One-Hot</strong>.</p><ol><li><strong>Encodage de la variable "Type de produit"</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># One-Hot Encoding pour la variable catégorielle "Type de produit"</span>
df_encoded = pd.get_dummies(df, columns=[<span class="hljs-string">'Type de produit'</span>], drop_first=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># Afficher les premières lignes du DataFrame encodé</span>
<span class="hljs-built_in">print</span>(df_encoded.head())
</code></div></div></pre><ol start="2"><li><strong>Séparation des variables explicatives et de la variable cible</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Séparer les variables explicatives (features) et la variable cible (target)</span>
X = df_encoded.drop(columns=[<span class="hljs-string">'Qualité du produit (0= mauvaise, 1= bonne)'</span>])
y = df_encoded[<span class="hljs-string">'Qualité du produit (0= mauvaise, 1= bonne)'</span>]

<span class="hljs-comment"># Diviser les données en ensemble d'entraînement (80%) et ensemble de test (20%)</span>
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># Vérification des dimensions après séparation</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions d'entraînement : "</span>, X_train.shape, y_train.shape)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Dimensions de test : "</span>, X_test.shape, y_test.shape)
</code></div></div></pre><hr><h4><strong>Étape 4 : Entraînement du modèle avec un arbre de décision</strong></h4><p>Nous allons maintenant entraîner un <strong>arbre de décision</strong> pour classifier les produits en fonction de leur qualité.</p><ol><li><strong>Entraînement du modèle d'arbre de décision</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier

<span class="hljs-comment"># Créer et entraîner un modèle d'arbre de décision</span>
tree_model = DecisionTreeClassifier(random_state=<span class="hljs-number">42</span>)
tree_model.fit(X_train, y_train)

<span class="hljs-comment"># Afficher l'arbre de décision</span>
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> plot_tree
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">8</span>))
plot_tree(tree_model, filled=<span class="hljs-literal">True</span>, feature_names=X.columns, class_names=[<span class="hljs-string">"Mauvaise"</span>, <span class="hljs-string">"Bonne"</span>], rounded=<span class="hljs-literal">True</span>)
plt.show()
</code></div></div></pre><hr><h4><strong>Étape 5 : Évaluation du modèle</strong></h4><p>Nous allons évaluer la performance du modèle en utilisant des <strong>métriques de classification</strong> telles que la <strong>précision</strong>, le <strong>rappel</strong>, et la <strong>F1-score</strong>, ainsi qu'une <strong>matrice de confusion</strong>.</p><ol><li><strong>Évaluation de la performance</strong> :</li></ol><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report, accuracy_score, confusion_matrix

<span class="hljs-comment"># Faire des prédictions sur l'ensemble de test</span>
y_pred = tree_model.predict(X_test)

<span class="hljs-comment"># Précision du modèle</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Précision du modèle : "</span>, accuracy_score(y_test, y_pred))

<span class="hljs-comment"># Rapport de classification (précision, rappel, F1-score)</span>
<span class="hljs-built_in">print</span>(classification_report(y_test, y_pred))

<span class="hljs-comment"># Matrice de confusion</span>
conf_matrix = confusion_matrix(y_test, y_pred)
sns.heatmap(conf_matrix, annot=<span class="hljs-literal">True</span>, fmt=<span class="hljs-string">"d"</span>, cmap=<span class="hljs-string">"Blues"</span>, xticklabels=[<span class="hljs-string">"Mauvaise"</span>, <span class="hljs-string">"Bonne"</span>], yticklabels=[<span class="hljs-string">"Mauvaise"</span>, <span class="hljs-string">"Bonne"</span>])
plt.xlabel(<span class="hljs-string">'Prédictions'</span>)
plt.ylabel(<span class="hljs-string">'Réel'</span>)
plt.title(<span class="hljs-string">'Matrice de confusion'</span>)
plt.show()
</code></div></div></pre><hr><h4><strong>Étape 6 : Visualisation des résultats</strong></h4><p>Nous allons également visualiser les résultats sous forme de graphique pour mieux comprendre la performance du modèle.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python"><span class="hljs-comment"># Visualisation des résultats réels vs prédits</span>
plt.scatter(y_test, y_pred)
plt.xlabel(<span class="hljs-string">'Valeurs réelles'</span>)
plt.ylabel(<span class="hljs-string">'Valeurs prédites'</span>)
plt.title(<span class="hljs-string">'Qualité réelle vs prédit'</span>)
plt.show()
</code></div></div></pre><hr><h4><strong>Étape 7 : Améliorations possibles</strong></h4><p>Si la performance du modèle n'est pas satisfaisante, nous pouvons envisager plusieurs améliorations, telles que :</p><ol><li><p><strong>Pruning (élagage) de l'arbre</strong> : Simplifier l'arbre en limitant sa profondeur pour éviter l'overfitting.</p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none">python</div><div class="sticky top-9 md:top-[5.75rem]"><div class="absolute bottom-0 right-2 flex h-9 items-center"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class="" data-state="closed"><button class="flex gap-1 items-center select-none py-1"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"></path></svg>Copier le code</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-python">tree_model_pruned = DecisionTreeClassifier(max_depth=<span class="hljs-number">3</span>, random_state=<span class="hljs-number">42</span>)
tree_model_pruned.fit(X_train, y_train)
y_pred_pruned = tree_model_pruned.predict(X_test)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Précision du modèle élagué : "</span>, accuracy_score(y_test, y_pred_pruned))
</code></div></div></pre></li><li><p><strong>Utiliser des modèles d'assemblage</strong> comme <strong>Forêts aléatoires (Random Forest)</strong> ou <strong>Gradient Boosting</strong> pour améliorer la robustesse et la précision.</p></li><li><p><strong>Optimisation des hyperparamètres</strong> : Ajuster des paramètres comme la profondeur maximale de l'arbre, le critère de séparation (<code>gini</code> ou <code>entropy</code>), etc.</p></li></ol><hr><h3><strong>Conclusion :</strong></h3><p>Dans cette activité, nous avons créé un modèle prédictif utilisant un <strong>arbre de décision</strong> pour prédire la qualité des produits dans le secteur agroalimentaire. Nous avons introduit les types de produits (Yaourt, Biscuit, Sauce) dans notre modèle, exploré les données, préparé les caractéristiques, et évalué les performances du modèle avec des métriques adaptées à la classification. Ce modèle permet de prédire si un produit sera de <strong>bonne</strong> ou <strong>mauvaise qualité</strong> en fonction des paramètres de production.</p></div></div></div>
